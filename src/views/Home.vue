<template>
  <div class='home_template'>
    <div class='home-banner' id='WebGL-output'>
      <div class='home-banner-content' >
        <div class='home-banner-h1'>INVINCIBLE GAME WORLD</div>
        <div class='home-banner-title'>—全球游戏生态联盟—</div>
        <div class='home-banner-doc'>全新的游戏经济生态基础设施</div>
      </div>
    </div>
    <div class='gwi-row'>
        <div class='gwi-row-content'>
          <div class='gwi-row-title'>IGW简介</div>
          <div class='gwi-doc'>
            IGW全球游戏生态联盟致力打造一个基于区块链原生的泛社区化游戏平台，聚合游戏玩家、游戏内容生产者、开发者、数字资产交易者等多种泛社区成员，为游戏玩家提供优质的游戏内容，为开发者提供完善的游戏开发模块、数据服务及流量支持，且无中间费用，用户可使用平台通证IGC进行游戏数字资产的自由交易和跨链流通，社区内容完全由社区成员推动而实现自治管理和规范运作。
          </div>
          <div class='gwi-row-more'>
            点击了解更多
          </div>
        </div>
    </div>
    <div class='gwi-row analysis-row'>
        <div class='gwi-row-content'>
          <div class='gwi-row-title font-while'>区块链行业宏观分析</div>
          <div class='analysis-title'>
            <div class='analysis-p'>传统游戏市场日趋成熟的同时</div>
            <div class='analysis-p analysis-p-blod'>也出现了诸多问题</div>
          </div>
          <div class='gwi-book-group'>
            <div class='gwi-book-item'>
              <img src="@/assets/img/book1.png" alt="">
            </div>
            <div class='gwi-book-item'>
              <img src="@/assets/img/book2.png" alt="">
            </div>
            <div class='gwi-book-item'>
              <img src="@/assets/img/book3.png" alt="">
            </div>
            <div class='gwi-book-item'>
              <img src="@/assets/img/book4.png" alt="">
            </div>
          </div>
          <div class='gwi-row-more btn-while'>
            点击了解更多
          </div>
        </div>
    </div>
    <div class='gwi-row union-row'>
        <div class='gwi-row-content'>
          <div class='gwi-row-title'>IGW全球游戏生态联盟</div>
          <div class='gwi-doc'>
            IGW能够为游戏生态参与者提供更丰富的服务和生态模式，通过颠覆性的商业模式和区块链技术解决目前游戏行业的真实痛点。相比于其他游戏公链，IGW的构想和设计将更容易更快实现大规模落地应用，我们将结合现有技术，对整体行业逐步进行迭代改造。
          </div>
          <div class='gwi-gw-group'>
            <div class='gwi-gw-item'>
              <img src="@/assets/img/gw1.png" alt="">
              <span>流量共享</span>
            </div>
            <div class='gwi-gw-item'>
              <img src="@/assets/img/gw2.png" alt="">
              <span>一键全球发行</span>
            </div>
            <div class='gwi-gw-item'>
              <img src="@/assets/img/gw3.png" alt="">
              <span>去中介化</span>
            </div>
            <div class='gwi-gw-item'>
              <img src="@/assets/img/gw4.png" alt="">
              <span>资产流通</span>
            </div>
          </div>
          <div class='gwi-row-more'>
            点击了解更多
          </div>
        </div>
    </div>
    <div class='gwi-row tv-row'>
        <div class='gwi-row-content'>
          <div class='igw_left'>
            <div class='igw_h'>IGW Basics</div>
            <div class='igw_p'>为游戏而生！</div>
            <div class='igw-software-group'>
              <div class='igw-software-item'>
                <img src="@/assets/img/icon1.png" alt="">
                <span>社区</span>
              </div>
              <div class='igw-software-item'>
                <img src="@/assets/img/icon2.png" alt="">
                <span>商店</span>
              </div>
              <div class='igw-software-item'>
                <img src="@/assets/img/icon3.png" alt="">
                <span>IM/超群</span>
              </div>
              <div class='igw-software-item'>
                <img src="@/assets/img/icon4.png" alt="">
                <span>钱包</span>
              </div>
            </div>
          </div>
          <div class='igw_right'>
            <img src="@/assets/img/icon_tv.png" alt="">
          </div>
        </div>
    </div>
    <div class='gwi-row powered-row'>
        <img src="@/assets/img/bg1.png" alt="">
        <div class='gwi-row-more btn-while'>
            点击了解更多
          </div>
    </div>
    <div class='gwi-row fund-row'>
        <div class='gwi-row-content'>
          <div class='gwi-row-title'>IGW基金会</div>
          <div class='fund-row-content'>
            <div class='fund-row-left'>
              IGWF注册于英属群岛直布罗陀，是全球游戏生态联盟体系的发起者。我们致力于聚合全球各地区（大洲、国家或地区）有共同志向的游戏平台、游戏开发者、运营者打造未来游戏联盟经济体，共同创建一个为游戏行业参与者走向全球市场的渠道，通过区块链技术手段及完善的解决方案实现联盟成员的相互信任、流量共享、平等共赢。
            </div>
            <div class='fund-row-right'>
              <img src="@/assets/img/map.png" alt="">
            </div>
          </div>
          <div class='gwi-row-more'>
            点击了解更多
          </div>
        </div>
    </div>
     <div class='gwi-row history-row'>
        <div class='gwi-row-title font-while'>路线图</div>
        <img src="@/assets/img/bg2.png" alt="">
    </div>
    <div class='gwi-row callme-row'>
        <div class='gwi-row-content'>
          <div class='gwi-row-title'>联系我们</div>
          <div class='form-content'>
            <el-form :model="ruleForm" :rules="rules" ref="ruleForm" >
              <el-form-item prop="user_name" class='form-item-input input-name'>
                <label >姓名 | NAME</label>
                <el-input type="text" maxlength='8' v-model="ruleForm.user_name" ></el-input>
              </el-form-item>
               <el-form-item prop="user_phone" class='form-item-input input-phone'>
                <label >电话 | PHONE</label>
                <el-input type="tel" maxlength="11"  v-model="ruleForm.user_phone"></el-input>
              </el-form-item>
              <el-form-item  prop="user_message" class='form-item-textarea' >
                <label >留言 | MESSAGE</label>
                <el-input type="textarea" maxlength="120" v-model="ruleForm.user_message" autocomplete="off"></el-input>
              </el-form-item>
            </el-form>
            <!-- <div class='form-item-input'>
              <label >姓名 | NAME</label>
              <input type="text" v-model="user_name">
            </div>
            <div class='form-item-input'>
              <label >电话 | PHONE</label>
              <input type="tel" maxlength="11" class='input-phone' v-model="user_phone">
            </div>
            <div class='form-item-textarea'>
              <label >留言 | MESSAGE</label>
              <textarea rows="4" v-model="user_message"></textarea>
            </div> -->
            <div class='form-btn-group'>
              <div class='form-btn' @click='addMessage'>发送留言</div>
            </div>
          </div>
        </div>
    </div>
  </div>
</template>
<script>
import Axios from 'axios';
import * as THREE from 'three'
import dat from 'dat.gui'
import $ from 'jquery'
export default {
  mounted(){
       // create a scene, that will hold all our elements such as objects, cameras and lights.
        var scene = new THREE.Scene();

        // create a camera, which defines where we're looking at.
        var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);

        // create a render and set the size
        var webGLRenderer = new THREE.WebGLRenderer();
        webGLRenderer.setClearColor(new THREE.Color(0x000000, 0.0));
        webGLRenderer.setSize(window.innerWidth, window.innerHeight);
        webGLRenderer.shadowMapEnabled = true;

        // position and point the camera to the center of the scene
        camera.position.x = -30;
        camera.position.y = 40;
        camera.position.z = 50;
        camera.lookAt(new THREE.Vector3(10, 0, 0));

        // add the output of the renderer to the html element
        $("#WebGL-output").append(webGLRenderer.domElement);

        // call the render function
        var step = 0;

        var knot;

        // setup the control gui
        var controls = new function () {
            // we need the first child, since it's a multimaterial
            this.radius = 40;
            this.tube = 28.2;
            this.radialSegments = 600;
            this.tubularSegments = 12;
            this.p = 5;
            this.q = 4;
            this.heightScale = 4;
            this.asParticles = true;
            this.rotate = true;

            this.redraw = function () {
                // remove the old plane
                if (knot) scene.remove(knot);
                // create a new one
                var geom = new THREE.TorusKnotGeometry(controls.radius, controls.tube, Math.round(controls.radialSegments), 
                Math.round(controls.tubularSegments), Math.round(controls.p), Math.round(controls.q), controls.heightScale);

                if (controls.asParticles) {
                    knot = createParticleSystem(geom);
                } else {
                    knot = createMesh(geom);
                }

                // add it to the scene.
                scene.add(knot);
            };

        }

        // var gui = new dat.GUI();
        // gui.add(controls, 'radius', 0, 40).onChange(controls.redraw);
        // gui.add(controls, 'tube', 0, 40).onChange(controls.redraw);
        // gui.add(controls, 'radialSegments', 0, 400).step(1).onChange(controls.redraw);
        // gui.add(controls, 'tubularSegments', 1, 20).step(1).onChange(controls.redraw);
        // gui.add(controls, 'p', 1, 10).step(1).onChange(controls.redraw);
        // gui.add(controls, 'q', 1, 15).step(1).onChange(controls.redraw);
        // gui.add(controls, 'heightScale', 0, 5).onChange(controls.redraw);
        // gui.add(controls, 'asParticles').onChange(controls.redraw);
        // gui.add(controls, 'rotate').onChange(controls.redraw);
      
        // gui.close();

        controls.redraw();

        render();

        // from THREE.js examples
        function generateSprite() {

            var canvas = document.createElement('canvas');
            canvas.width = 16;
            canvas.height = 16;

            var context = canvas.getContext('2d');
            var gradient = context.createRadialGradient(canvas.width / 2, canvas.height / 2, 0, canvas.width / 2, canvas.height / 2, canvas.width / 2);
            gradient.addColorStop(0, 'rgba(255,255,255,1)');
            gradient.addColorStop(0.2, 'rgba(0,255,255,1)');
            gradient.addColorStop(0.4, 'rgba(0,0,64,1)');
            gradient.addColorStop(1, 'rgba(0,0,0,1)');

            context.fillStyle = gradient;
            context.fillRect(0, 0, canvas.width, canvas.height);

            var texture = new THREE.Texture(canvas);
            texture.needsUpdate = true;
            return texture;

        }

        function createParticleSystem(geom) {
            var material = new THREE.ParticleBasicMaterial({
                color: 0xffffff,
                size: 3,
                transparent: true,
                blending: THREE.AdditiveBlending,
                map: generateSprite()
            });

            var system = new THREE.ParticleSystem(geom, material);
            system.sortParticles = true;
            return system;
        }

        function createMesh(geom) {

            // assign two materials
            var meshMaterial = new THREE.MeshNormalMaterial({});
            meshMaterial.side = THREE.DoubleSide;

            // create a multimaterial
            var mesh = THREE.SceneUtils.createMultiMaterialObject(geom, [meshMaterial]);

            return mesh;
        }

        function render() {
           
            if (controls.rotate) {
                knot.rotation.y = step += 0.01;
            }

            // render using requestAnimationFrame
            requestAnimationFrame(render);
            webGLRenderer.render(scene, camera);
        }

  },
  data(){
    var validatename = (rule, value, callback) => {
        if (value === '') {
          callback(new Error('请输入姓名'));
        } else {
          callback();
        }
    };
    var validatephone = (rule, value, callback) => {
        if (value === '') {
          callback(new Error('请输入手机号'));
        } else {
          if(!(/^1[3456789]\d{9}$/.test(value))){   
              callback(new Error('手机号格式不正确')); 
          }else{
            callback();
          } 
          
        }
    };
    var validatemessage = (rule, value, callback) => {
        if (value === '') {
          callback(new Error('请输入留言信息'));
        } else {
          callback();
        }
    };
    return {
      ruleForm:{
        user_name:'',
        user_phone:'',
        user_message:'',
      },
     
      rules: {
        user_name: [
          { validator: validatename, trigger: 'blur' }
        ],
        user_phone: [
          { validator: validatephone, trigger: 'blur' }
        ],
        user_message: [
          { validator: validatemessage, trigger: 'blur' }
        ]
      }
    }
  },
  methods: {
    addMessage(){
      this.$refs['ruleForm'].validate((valid) => {
          if (valid) {
            this.setAddmessage()
          } else {
            return false;
          }
        });
    },
    setAddmessage(){
      const api_url = '/leaving-message/add'
      Axios.post(api_url,{
        user_name:this.ruleForm.user_name,
        phone:this.ruleForm.user_phone,
        message:this.ruleForm.user_message
      })
      .then(res=>{
        let data=res.data
        if(data.code===0){
          this.ruleForm.user_name=''
          this.ruleForm.user_phone=''
          this.ruleForm.user_message=''
          this.$message({
          message: data.message,
          type: 'success'
        });
        }           
      })
    }
  },

}
</script>
<style lang="scss">
  .home_template{
    .home-banner{
      width:100%;
      height:350px;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      .home-banner-content{
        text-align: center;
        color:#fff;
        position: absolute;
        .home-banner-h1{
          font-size:36px;
          font-family:DINBlackAlternate;
        }
        .home-banner-title{
          font-size:25px;
          margin-top:20px;
        }
        .home-banner-doc{
          font-size:13px;
          letter-spacing:20px;
          margin-top:40px;
        }
      }
    }
    .gwi-doc{
      width:100%;
      font-size:14px;
      color:#595959;
      text-align: center;
      line-height: 30px;
      letter-spacing: 2px;
      margin-bottom:80px;
    }
    .analysis-row{
      background:#1B1349;
      .analysis-title{
        width:100%;
        .analysis-p{
          font-size:18px;
          color:#fff;
          line-height: 24px;
          &.analysis-p-blod{
            font-weight: bold;
          }
        }
      }
      .gwi-book-group{
        width:100%;
        margin-top:30px;
        margin-bottom: 45px;
        display: flex;
        justify-content: space-around;
        .gwi-book-item{
          width:25%;
          margin-right:30px;
          transition: all 0.2s linear;
          &:last-child{
            margin-right:0;
          }
          img{
            width:100%;
          }
          &:hover{
            transform: scale(1.1)
          }
        }
      }
    }
    .union-row{
      background:#EDEFF2;
      .gwi-doc{
        margin-bottom: 40px;
      }
      .gwi-gw-group{
        display: flex;
        justify-content: space-between;
        margin-bottom: 50px;
        .gwi-gw-item{
          width:96px;
          text-align: center;
          transition: all 0.2s linear;
          &:hover{
            transform: scale(1.1)
          }
          img{
            width:100%;
          }
          span{
            display: block;
            margin-top:30px;
            color:#07070D;
          }
           
        }
      }
    }
    .tv-row{
      .gwi-row-content{
        display: flex;
        height: 400px;
        justify-content:space-between;
        .igw_left{
          .igw_h{
            font-size: 36px;
            color:#07070D;
            font-weight: bold;
          }
          .igw_p{
            font-size: 24px;
            color:#07070D;
          }
          .igw-software-group{
            display: flex;
            justify-content: space-between;
            margin-top:10px;
            .igw-software-item{
              text-align: center;
              width:20%;
              span{
                display: block;
              }
              img{
                width:100%;
                border-radius:12px;
                &:hover{
                  box-shadow:0px 13px 31px 3px rgba(0, 0, 0, 0.2);
                }
              }
            }
          }
        }
        .igw_right{
          img{
            height:440px;
            position: relative;
            top:40px;
            z-index: 3;
          }
        }
      }
    }
    .powered-row{
      position: relative;
      background:#1B1349;
      img{
        width:1400px;
        display: block;
        margin:0 auto;
      }
      .gwi-row-more{
        position: absolute;
        bottom:50px;
        left:50%;
        transform: translate(-50%,0)
      }
    }
    .fund-row{
      background:#EDEFF2;
      .fund-row-content{
        display: flex;
        justify-content: space-between;
        margin-bottom: 40px;
        .fund-row-left{
          line-height:30px;
          width:50%;
        }
        .fund-row-right{
          text-align: center;
          img{
            width:80%;
          }
        }
      }
    }
    .history-row{
      position: relative;
      background:#1B1349;
      img{
        width:100%;
        display: block;
        margin:0 auto;
      }
      .gwi-row-title{
        position: absolute;
        top:50px;
        left:50%;
        transform: translate(-50%,0)
      }
    }
    .callme-row{
      background: #fff;
      .form-content{
        width:400px;
        margin:0 auto;
        .form-item-input{
          display: inline-block;
          width:50%;
          label{
            color:#595959;
            font-size:12px;
            display: block;
            margin-bottom: 10px;
          }
          input{
            display: inline-block;
            width:140px;
            height:29px;
            background:#F3F3F3;
            box-shadow:0px 1px 0px 0px rgba(255,255,255,1);
            border-radius:14px;
            outline: none;
            border:0;
            padding:4px 10px;
            box-sizing: border-box;
            &.input-phone{
              width:200px;
            }
          }
          &.input-name{
            width:140px;
            .el-form-item__content{
              width: 140px !important;;
            }
          }
          &.input-phone{
            width:200px;
            margin-left:60px;
            .el-form-item__content{
              width: 200px !important;
              .el-input__inner{
                width:200px!important;
              }
            }
          }
        }
        .form-item-textarea{
          width:50%;
          margin-top:20px;
          label{
            color:#595959;
            font-size:12px;
            display: block;
            margin-bottom: 10px;
          }
          textarea{
            display: inline-block;
            width:400px;
            height:103px;
            background:#F3F3F3;
            box-shadow:0px 1px 0px 0px rgba(255,255,255,1);
            border-radius:14px;
            outline: none;
            border:0;
            padding:10px;
            box-sizing: border-box;
          }
        }
        .form-btn-group{
          width:100%;
          margin:35px 0 0;
          .form-btn{
            width:131px;
            height:38px;
            background:#1862E9;
            box-shadow:0px 6px 11px 0px rgba(0, 0, 0, 0.2);
            border-radius:19px;
            text-align: center;
            line-height: 38px;
            text-align: center;
            font-size:16px;
            color:#fff;
            margin:0 auto;
            cursor: pointer;
          }
        }
      }
    }
  }
</style>